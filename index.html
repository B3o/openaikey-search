<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <title>API查询</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div class="container">
  <div class="left">
    <h1>API信息查询页面</h1>
    <div>(apikey仅查询可用性，session可查询额度)</div>
    <div>
      <label for="apiUrlInput"></label>
      <select id="apiUrlInput">
        <option value="https://openai.lan-qian.top">
          【自建反代】 https://openai.lan-qian.top
        </option>
        <option value="https://openai.lqqq.ltd">
          【自建反代2】 https://openai.lqqq.ltd
        </option>
        <option value="https://api.openai.com">
          【官方,需科学】 https://api.openai.com
        </option>
      </select>
    </div>
    <div class="input">
      <label for="apiKeyInput"></label>
      <textarea id="apiKeyInput" placeholder="请输入要查询的apikey或用session，全部丢进来就行，自动识别，无视格式和数量(任何带有sk-或sess-的文本)"></textarea>
      <div>
        <input type="checkbox" id="showFullApiKey" />
        <label for="showFullApiKey">右侧显示完整APIKEY</label>
      </div>
      <div>
        <button onclick="sendCurlRequests()">查询api</button>
        <button onclick="getApiKey()">提取key</button>
        <button onclick="getSessKey()">提取sess</button>
<!--        <button onclick="getAccToken()">提取token</button>-->
      </div>
    </div>
    <h3>需要低价账号来LQ小店<a href="https://fk.lqqq.ltd" target="_blank">点击此处</a></h3>
<!--    <h3>session获取：<a href="https://sess.lqqq.ltd" target="_blank">点击此处</a></h3>-->
  </div>
  <div class="right">
    <div class="result-container">
      <div class="result" id="resultSection">
        <table id="resultTable">
          <tr>
            <th>sk-/sess-</th>
            <th>总额度/可用性</th>
            <th>已用额度</th>
            <th>剩余额度</th>
            <th>到期时间</th>
            <th>快速</th>
            <th>先用后付</th>
            <th>GPT4</th>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
<script>
    function initArkoseEnforcement() {
        const publicKey = '0655BC92-82E1-43D9-B32E-9DF9B01AF50C';
        const arkoseScriptSrc = '/v2/' + publicKey + '/api.js';
        let arkose = null;

        function setupEnforcement(myEnforcement) {
            arkose = myEnforcement;
            arkose.setConfig({
                data: {
                    blob: "ZL3OFuWmqM5gI64o.ANoVz2gG/uAxtWI2796SCIYucQodDrAXc5hC1XZOVTaVfTrsKaQrVIKg/LPYB7YPXP/pt35udD6xNX0bOK38AjcyTHQKYsgiazNQgh7FCTR8RoSWQqNTDR/4b4c4iPlusVRfLYIc34JckHbBsJXZZsEQCVziJJ7jTMWeYfOd73muKVqrAeGX7RuPikR+3VIT2zZuHzhtZzAoamPuzvWHCOmS+ruullOwBXjijQQJ18IQLY+4wdSOkMAmQX0brYllq95YlniKuxZ9o2GmQfp2PK2Ob89xzLBABG6gSHl96D1KU53Uw9/bTD9kTnijJu7px2apMW7psyiyAevIvhmbWtlEHO7InoJ577/5NPGi6/Fo+tFPX+D2BfnNTEI0GMqYGyQ0p/jS/JGcTSNq7yHsSJjp32FzmJNUR5rtAVt+OgUf7rFg54Fg59nElrVMg77hoYDdu6Ugmtos5BNWV7cGu7jaz+T0XjCeLYyfYc3pX+tosgZQsPf89RMkDEqJrouZI4MT6zXMwiAPw+5OOS8V9TkCKBfsv6sC6lyYFxzbAwe6gEqcxi89iiH2U5xpRFJAlOjdiY5DQY2z+6oyW+PFVxGbvEBo2q80FGrefecD3lwEpfJUnn64nCSSo/R8OFMrBznysvx03ehlORbzw7iL8iKZXEOEy7q4su6pKBzwbEWXCTPW3d8eTLSfCghd9mtt5fDTKCZ/Meqcxz+/6T3uNRTlgZdDcZo3dbxreDxQ+6onuZXlDj9tiumLeuTp5VDqd1NvoUrHFMziNmHToFe1KGxhVb3pYNk="
                },
                onReady: function () {
                    arkose.run();
                },
                onCompleted: function (response) {
                    const token = response.token;
                    if (token.includes("sup=1")){
                        window.location.reload();
                    } else{
                        postCallback(token);
                    }
                },
                onError: function (response) {
                    window.location.reload();
                }
            });
        }

        function createArkoseScript() {
            let script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = arkoseScriptSrc;
            script.setAttribute('data-callback', 'setupEnforcement');
            script.async = true;
            script.defer = true;
            document.getElementsByTagName('head')[0].appendChild(script);
        }


        function postCallback(token) {
            fetch('/fc/a/callback', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    public_key: publicKey,
                    token: token
                })
            }).then(response => {
                window.location.reload();
            }).catch(error => {
                window.location.reload();
            });
        }

        function loadArkose() {
            if (document.readyState === 'interactive' || document.readyState === 'complete') {
                createArkoseScript();
            } else {
                document.addEventListener('DOMContentLoaded', createArkoseScript);
            }
        }

        window.setupEnforcement = setupEnforcement;
        loadArkose();
    }

    initArkoseEnforcement();
</script>
<script src="script.js"></script>
</body>
</html>
